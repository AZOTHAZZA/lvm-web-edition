<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LOGOS LOGIC ENGINE - LVM Edition v2.5.5</title>
    <style>
        body {
            background-color: #050505;
            color: #d4af37;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #terminal {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            border-bottom: 1px solid #333;
        }
        #input-area {
            padding: 15px;
            background: #111;
            display: flex;
        }
        input {
            flex-grow: 1;
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: inherit;
            font-size: 1.1em;
            outline: none;
        }
        .status-bar {
            font-size: 0.8em;
            padding: 5px 20px;
            background: #000;
            display: flex;
            justify-content: space-between;
            color: #666;
        }
        .ready { color: #00ff00 !important; }
        .error { color: #ff0000 !important; }
    </style>
</head>
<body>

    <div class="status-bar">
        <span>SYSTEM_ID: LVM-01</span>
        <span id="node-status">NODE_STATUS: INITIALIZING...</span>
        <span>VER: 2.5.5-ATOMIC</span>
    </div>

    <div id="terminal">
        <div style="color: #fff; margin-bottom: 20px;">
            <h1># LOGOS LOGIC ENGINE</h1>
            <p style="color: #888;">"The limits of my language mean the limits of my world."</p>
        </div>
        <div id="output-stream"></div>
    </div>

    <div id="input-area">
        <span style="margin-right: 10px;">&gt;</span>
        <input type="text" id="user-input" placeholder="Enter logic sequence..." autofocus>
    </div>

    <script src="LogosDecimal.js"></script>
    <script src="LogosCore.js"></script>
    <script>
        (function() {
            // 1. 記憶層の即時確立
            window.LogosStorage = {
                save: (key, data) => localStorage.setItem(`LVM_${key}`, JSON.stringify(data)),
                load: (key) => JSON.parse(localStorage.getItem(`LVM_${key}`) || 'null'),
                getAssets: function() { return this.load('ASSETS') || {}; },
                registerAsset: function(symbol, details) {
                    const assets = this.getAssets();
                    assets[symbol] = { symbol, balance: details.balance || '0' };
                    this.save('ASSETS', assets);
                    sysLog("STORAGE: ASSET_LOCKED: " + symbol, "system");
                }
            };

            // 2. 通信橋の即時確立
            window.LVM_BRIDGE = {
                processCommand: function(input) {
                    const args = input.trim().toUpperCase().split(/\s+/);
                    if (args[0] === "GENERATE") {
                        window.LogosStorage.registerAsset(args[2], { balance: "0" });
                        sysLog(`SUCCESS: ${args[2]}_GENERATED`, "system");
                    } else {
                        sysLog(`UNKNOWN_COMMAND: ${args[0]}`, "error");
                    }
                }
            };
        })();

        // UI制御
        const outputStream = document.getElementById('output-stream');
        const userInput = document.getElementById('user-input');
        const nodeStatus = document.getElementById('node-status');

        function sysLog(text, type = 'normal') {
            const div = document.createElement('div');
            div.style.marginBottom = '10px';
            if (type === 'system') div.style.color = '#d4af37';
            if (type === 'error') div.classList.add('error');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${text}`;
            outputStream.appendChild(div);
            outputStream.scrollTop = outputStream.scrollHeight;

            if (text.includes("READY")) {
                nodeStatus.textContent = "NODE_STATUS: READY";
                nodeStatus.classList.add('ready');
            }
        }

        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && userInput.value.trim() !== "") {
                const msg = userInput.value;
                sysLog(`USER: ${msg}`);
                userInput.value = "";
                window.LVM_BRIDGE.processCommand(msg);
            }
        });

        window.onload = () => {
            sysLog("Logos Logic Notebook v2.5.5 - Atomic Active", "system");
            setTimeout(() => {
                sysLog("LVM_SYSTEM: ALL_SYSTEMS_OPERATIONAL_READY", "system");
            }, 500);
        };
    </script>
</body>
</html>